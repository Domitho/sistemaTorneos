{% extends 'plantilla.html' %}
{% block contenido %}
<h3 class="text-center mb-4">Panel de Estadísticas del Torneo</h3>
<div class="row">
    <div class="col-md-6 mb-4"><div id="grafico1" style="height:300px;"></div></div>
    <div class="col-md-6 mb-4"><div id="grafico2" style="height:300px;"></div></div>
    <div class="col-md-6 mb-4"><div id="grafico3" style="height:300px;"></div></div>
    <div class="col-md-6 mb-4"><div id="grafico4" style="height:300px;"></div></div>
    <div class="col-md-6 mb-4"><div id="grafico5" style="height:300px;"></div></div>
    <div class="col-md-6 mb-4"><div id="grafico6" style="height:300px;"></div></div>
    <div class="col-md-6 mb-4"><div id="grafico7" style="height:300px;"></div></div>
    <div class="col-md-6 mb-4"><div id="grafico8" style="height:300px;"></div></div>
    <div class="col-md-6 mb-4"><div id="grafico9" style="height:300px;"></div></div>
    <div class="col-md-6 mb-4"><div id="grafico10" style="height:300px;"></div></div>
</div>
{% endblock %}

{% block scripts %}
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script>
google.charts.load('current', {'packages':['corechart', 'bar', 'table', 'gauge']});
google.charts.setOnLoadCallback(drawCharts);

function drawCharts() {
    // 1. ColumnChart - Partidos por torneo
    const data1 = google.visualization.arrayToDataTable([
        ['Torneo', 'Partidos', { role: 'annotation' }],
        {% for nombre, total in partidos_por_torneo %}
        ['{{ nombre }}', {{ total }}, '{{ total }}'],
        {% endfor %}
    ]);
    new google.visualization.ColumnChart(document.getElementById('grafico1')).draw(data1, {
        title: 'Partidos por torneo'
    });

    // 2. PieChart - Equipos por descripción
    const data2 = google.visualization.arrayToDataTable([
        ['Descripción', 'Cantidad'],
        {% for descripcion, total in equipos_por_descripcion %}
        ['{{ descripcion }}', {{ total }}],
        {% endfor %}
    ]);
    new google.visualization.PieChart(document.getElementById('grafico2')).draw(data2, {
        title: 'Equipos por descripción',
        pieSliceText: 'value'
    });

    // 3. BarChart - Partidos por estadio
    const data3 = google.visualization.arrayToDataTable([
        ['Estadio', 'Partidos', { role: 'annotation' }],
        {% for estadio, total in partidos_por_estadio %}
        ['{{ estadio }}', {{ total }}, '{{ total }}'],
        {% endfor %}
    ]);
    new google.visualization.BarChart(document.getElementById('grafico3')).draw(data3, {
        title: 'Partidos por estadio'
    });

    // 4. Gauge - Promedio de edad árbitros
    const data4 = google.visualization.arrayToDataTable([
        ['Label', 'Value'],
        ['Edad', {{ promedio_edad_arbitros }}]
    ]);
    new google.visualization.Gauge(document.getElementById('grafico4')).draw(data4, {
        width: 300, height: 200,
        redFrom: 50, redTo: 100,
        yellowFrom:30, yellowTo: 50,
        minorTicks: 5
    });

    // 5. DonutChart - Top equipos
    const data5 = google.visualization.arrayToDataTable([
        ['Equipo', 'Jugadores'],
        {% for nombre, total in top_equipos %}
        ['{{ nombre }}', {{ total }}],
        {% endfor %}
    ]);
    new google.visualization.PieChart(document.getElementById('grafico5')).draw(data5, {
        title: 'Top equipos por jugadores',
        pieHole: 0.4,
        pieSliceText: 'value'
    });

    // 6. BarChart - Partidos por árbitro
    const data6 = google.visualization.arrayToDataTable([
        ['Árbitro', 'Partidos', { role: 'annotation' }],
        {% for arbitro, total in partidos_por_arbitro %}
        ['{{ arbitro }}', {{ total }}, '{{ total }}'],
        {% endfor %}
    ]);
    new google.visualization.BarChart(document.getElementById('grafico6')).draw(data6, {
        title: 'Partidos por árbitro',
        colors: ['#e0440e']
    });

    // 7. AreaChart - Partidos por fecha
    const data7 = google.visualization.arrayToDataTable([
        ['Fecha', 'Partidos', { role: 'annotation' }],
        {% for fecha, total in partidos_por_fecha %}
        ['{{ fecha }}', {{ total }}, '{{ total }}'],
        {% endfor %}
    ]);
    new google.visualization.AreaChart(document.getElementById('grafico7')).draw(data7, {
        title: 'Partidos por fecha',
        isStacked: true
    });

    // 8. Table - Duelos de equipos
    const data8 = google.visualization.arrayToDataTable([
        ['Equipo local', 'Equipo visitante', 'Cantidad'],
        {% for local, visitante, total in duelos_equipos %}
        ['{{ local }}', '{{ visitante }}', {{ total }}],
        {% endfor %}
    ]);
    new google.visualization.Table(document.getElementById('grafico8')).draw(data8, { showRowNumber: true });

    // 9. LineChart - Partidos por mes
    const data9 = google.visualization.arrayToDataTable([
        ['Mes', 'Partidos', { role: 'annotation' }],
        {% for mes, total in partidos_por_mes %}
        ['{{ mes }}', {{ total }}, '{{ total }}'],
        {% endfor %}
    ]);
    new google.visualization.LineChart(document.getElementById('grafico9')).draw(data9, {
        title: 'Partidos por mes'
    });

    // 10. Histogram - Estadios más usados
    const data10 = google.visualization.arrayToDataTable([
        ['Estadio', 'Cantidad'],
        {% for estadio, cantidad in estadios_top %}
        ['{{ estadio }}', {{ cantidad }}],
        {% endfor %}
    ]);
    new google.visualization.Histogram(document.getElementById('grafico10')).draw(data10, {
        title: 'Estadios más usados'
    });
}
</script>
{% endblock %}
